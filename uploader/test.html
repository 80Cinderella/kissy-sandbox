<!doctype html>
<html>
	<head>
		<meta charset="utf-8"/>
		<title></title>
	</head>
	<body>
		<h2>Uploader test</h2>
		<script src="../../kissy/build/test/test.js"></script>
		<script>KISSY.Test.Config.times = 1;</script>
		
		<script src="../../kissy/build/kissy.js"></script>
		<script src="../../kissy/build/flash/flash-pkg.js"></script>
		
		<script src="../../kissy-ajbridge/src/ajbridge/ajbridge.js"></script>
		
		
		<script src="uploader.js"></script>
		
		<div id="myFlashContent">
			 <a href="http://www.adobe.com/go/getflashplayer"> 
	         <img src="../../kissy-ajbridge/assets/get_flash_player.gif" alt="Get Adobe Flash player" /> 
	         </a> 
		</div>
		<br/>
		<button type="button" onclick="browse();">browse</button>
		<button type="button" onclick="upload();">upload</button>
		<button type="button" onclick="getFile();">getFile</button>
		<button type="button" onclick="removeFile();">removeFile</button>
		<button type="button" onclick="cancel();">cancel</button>
		<button type="button" onclick="lock();">lock</button>
		<button type="button" onclick="unlock();">unlock</button>
		
		
		<script>
			var S = KISSY,
				F = S.Flash,
				T = KISSY.Test
				A = AJBridge,
				Uploader = A.Uploader,
				config ={
					src:"uploader.swf",
					params:{
						bgcolor:"#FFCCCC",
						scale:"showall"
					},
					hand:true,
					btn:true
				},
				id="myFlashContent",
				uploader = new Uploader(id,config),
				cK,cV,
				files;
			
				function test_create(test){
					// 1.添加常规 AJBridge 监听
					uploader.on("init",function(ev){
						test.echo("<p>"+'id: ' + ev.id,',type: ' + ev.type,"</p>");
					});
					uploader.on("addCallback",function(ev){
						test.echo("<p>"+'id: ' + ev.id,',type: ' + ev.type,"</p>");
					});
					uploader.on("addCallbacks",function(ev){
						test.echo("<p>"+'id: ' + ev.id,',type: ' + ev.type,"</p>");
					});
					uploader.on("swfReady",function(ev){
						test.echo("<p>"+'id: ' + ev.id,',type: ' + ev.type,"</p>");
						S.log(uploader);
					});
					// 2.添加常规 内容 监听
					uploader.on("contentReady",function(ev){
						test.echo("<p>"+'id: ' + ev.id,',type: ' + ev.type,"</p>");
					});
					uploader.on("select",function(ev){
						test.echo("<p>"+'id: ' + ev.id,',type: ' + ev.type +", files:" + S.JSON.stringify(ev.files) + "</p>");
						files=ev.files;
					});
					uploader.on("cancel",function(ev){
						test.echo("<p>"+'id: ' + ev.id,',type: ' + ev.type,"</p>");
					});
					uploader.on("locked",function(ev){
						test.echo("<p>"+'id: ' + ev.id,',type: ' + ev.type,"</p>");
					});
					uploader.on("unlocked",function(ev){
						test.echo("<p>"+'id: ' + ev.id,',type: ' + ev.type,"</p>");
					});
					uploader.on("open",function(ev){
						test.echo("<p>"+'id: ' + ev.id,',type: ' + ev.type,"</p>");
					});
					uploader.on("progress",function(ev){
						test.echo("<p>"+'id: ' + ev.id,',type: ' + ev.type,"</p>");
					});
					uploader.on("complete",function(ev){
						test.echo("<p>"+'id: ' + ev.id,',type: ' + ev.type,"</p>");
					}); 
					uploader.on("uploadCompleteData",function(ev){
						test.echo("<p>"+'id: ' + ev.id,',type: ' + ev.type,"</p>");
					});
					uploader.on("listComplete",function(ev){
						test.echo("<p>"+'id: ' + ev.id,',type: ' + ev.type,"</p>");
					});
					uploader.on("httpStatus",function(ev){
						test.echo("<p>"+'id: ' + ev.id,',type: ' + ev.type,"</p>");
					});
					uploader.on("ioError",function(ev){
						test.echo("<p>"+'id: ' + ev.id,',type: ' + ev.type,"</p>");
					});
					uploader.on("securityError",function(ev){
						test.echo("<p>"+'id: ' + ev.id,',type: ' + ev.type,"</p>");
					});
					// 3.添加鼠标事件 监听
					uploader.on("mouseOver",function(ev){
						test.echo("<p>"+'id: ' + ev.id,',type: ' + ev.type,"</p>");
					});
					uploader.on("mouseDown",function(ev){
						test.echo("<p>"+'id: ' + ev.id,',type: ' + ev.type,"</p>");
					});
					uploader.on("mouseUp",function(ev){
						test.echo("<p>"+'id: ' + ev.id,',type: ' + ev.type,"</p>");
					});
					uploader.on("mouseOut",function(ev){
						test.echo("<p>"+'id: ' + ev.id,',type: ' + ev.type,"</p>");
					});
					uploader.on("click",function(ev){
						test.echo("<p>"+'id: ' + ev.id,',type: ' + ev.type,"</p>");
					});
					uploader.on("doubleClick",function(ev){
						test.echo("<p>"+'id: ' + ev.id,',type: ' + ev.type,"</p>");
					});
					// 4.初始化
					uploader.init();
				}
				
			
			function browse(){
				// 请注意 此处的  browse 并不是 开始浏览文件 ,而是做相关浏览配置
				T.echo("<p>"+'browse success: ' + uploader.browse(false) + "</p>");
			}
			function upload(){
				//TODO:
				uploader.upload("test.domain.com");
			}
			function cancel(){
				uploader.cancel(files[0].fid);
			}
			function getFile(){
				//TODO:
				T.echo("<p>"+'getFile: ' + uploader.getFile(files[0].fid) + "</p>");
			}
			function removeFile(){
				//TODO:
				uploader.removeFile(files[0].fid);
			}
			function lock(){
				uploader.lock();
			}
			function unlock(){
				uploader.unlock();
			}
				
		</script>
	</body>
</html>
